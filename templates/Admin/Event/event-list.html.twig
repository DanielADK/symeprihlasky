<section class="col-xs-12">
    <div class="box box-primary">
        <div class="box-header">
            <i class="fa fa-list"></i>
            <h1 class="box-title"> Všechny akce </h1>
            <div class="box-tools pull-right">
                <button type="button" class="btn btn-box-tool" data-widget="collapse"><i class="fa fa-minus"></i>
                </button>
            </div>
        </div>
        <div class="box-body">
            <table id="events" class="table table-hover table-striped table-bordered table-responsive">
                <thead>
                <tr class="text-center">
                    <th>ID</th>
                    <th>Zkratka</th>
                    <th>Celý název</th>
                    <th>Začátek</th>
                    <th>Konec</th>
                    <th>Typ</th>
                    <th>Aktivní přihláška</th>
                    <th>Cena člen</th>
                    <th>Cena nečlen</th>
                    {% if is_granted("ROLE_EDIT_EVENT") or is_granted("ROLE_DELETE_EVENT") %}
                        <th>Akce</th>
                        <th>Smazáno?</th>
                    {% endif %}

                </tr>
                </thead>
            </table>
        </div>
    </div>
</section>
<script>
    var ajaxURL;
    {% if is_granted("ROLE_DELETE_EVENT") %}
    ajaxURL = "/api/events";
    {% else %}
    ajaxURL = "/api/events?deleted=false";
    {% endif %}
    var columns = [
        {"data": "id"},
        {"data": "nameShort"},
        {"data": "nameFull"},
        {
            "data": null,
            render: function (data) {
                return ajaxPrepare("simpleDate", data.dateStart);
            }
        },
        {
            "data": null,
            render: function (data) {
                return ajaxPrepare("simpleDate", data.dateEnd);
            }
        },
        {
            "data": null,
            render: function (data) {
                return ajaxPrepare("type", data);
            }
        },
        {
            "data": null,
            render: function (data) {
                return ajaxPrepare("activeApplication", data);
            }
        },
        {
            "data": null,
            render: function (data) {
                return ajaxPrepare("priceMember", data);
            }
        },
        {
            "data": null,
            render: function (data) {
                return ajaxPrepare("priceOther", data);
            }
        },
        {% if is_granted("ROLE_EDIT_PERSON") or is_granted("ROLE_DELETE_PERSON") %}
        {
            "data": null,
            render: function(data) {
                return  '<div class="btn-group-vertical">' +
                        '<a href="/admin/akce/zobrazit/'+data.id+'" class="btn btn-block btn-info"><i class="fa fa-fw fa-info"></i>Informace</a>' +
                        '<a href="/admin/akce/upravit/'+data.id+'" class="btn btn-block btn-success"><i class="fa fa-fw fa-wrench"></i>Upravit</a>' +
                        '</div>'
            }
        },
        {
            "data": null,
            render: function(data) {
                if (data.deleted) {
                    return '<span class="label label-danger">SMAZÁN!</span>'
                } else {
                    return '<span class="label label-default">Nikoliv</span>';
                }
            }
        },
        {% endif %}


    ];
</script>
<script src="{{ asset("js/datatables/event-list.js") }}"></script>
{#{{ encore_entry_script_tags('event') }}#}