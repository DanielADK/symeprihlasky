{# /src/templates/Admin/Person/list.html.twig #}
{% extends "Admin/base.html.twig" %}
{% block title %}E-Přihlášky - Seznam uživatelů{% endblock %}
{% block stylesheets %}
    <link rel="stylesheet" type="text/css" href="{{ asset('adminlte/bower_components/datatables/datatables.min.css') }}">
{% endblock %}
{% block content %}
    <section class="content-wrapper">
        {% include "Admin/Modules/page_path_list.html.twig" %}

        <!-- Main content -->
        <section class="content container-fluid">
            {% include "Admin/Person/header-stats.html.twig" %}

            <section class="col-xs-12">
                <div class="box box-primary">
                    <div class="box-header">
                        <i class="fa fa-list"></i>
                        <h1 class="box-title"> Všichni uživatelé </h1>
                        <div class="box-tools pull-right">
                            <button type="button" class="btn btn-box-tool" data-widget="collapse"><i class="fa fa-minus"></i>
                            </button>
                        </div>
                    </div>
                    <!-- /.box-header -->
                    <div class="box-body">
                        <table id="people" class="table table-hover table-striped table-bordered table-responsive">
                            <thead>
                            <tr class="text-center">
                                <th>ID</th>
                                <th>Jméno <br>a příjmení</th>
                                <th>Email</th>
                                <th>Telefon</th>
                                <th>Role</th>
                                {% if is_granted("ROLE_EDIT_PERSON") or is_granted("ROLE_DELETE_PERSON") %}
                                    <th>Akce</th>
                                {% endif %}

                            </tr>
                            </thead>
                        </table>
                    </div>
                    <!-- /.box-body -->
                </div>
                <!-- /.box -->
            </section>
            <script>
                var ajaxURL = "/api/people?deleted=false";
                var columns = [
                    {"data": "id"},
                    {
                        "data": null,
                        render: function (data) {
                            return data.name + " " + data.surname;
                        }
                    },
                    {
                        "data": null,
                        render: function (data) {
                            return ajaxPrepare("email", data);
                        }
                    },
                    {
                        "data": null,
                        render: function (data) {
                            return ajaxPrepare("phone", data);
                        }
                    },
                    {
                        "data": null,
                        render: function (data) {
                            return ajaxPrepare("role", data.roles);
                        }
                    },
                    {% if is_granted("ROLE_EDIT_PERSON") or is_granted("ROLE_DELETE_PERSON") %}
                    {
                        "data": null,
                        render: function(data) {
                            return '<a href="/admin/uzivatele/upravit/'+data.id+'" class="btn btn-block btn-sm btn-success">Upravit<i class="fa fa-fw fa-wrench"></a>'
                        }
                    }
                    {% endif %}


                ];
            </script>
            <script src="{{ asset("js/datatables/person-list.js") }}"></script>

        </section>
    </section>
{% endblock %}
{% block javascripts %}
    <script src="{{ asset("adminlte/bower_components/datatables/datatables.min.js") }}"></script>
{% endblock %}